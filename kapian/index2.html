<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temperature Conversion Image Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            color: #333;
        }
        .input-section {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        textarea {
            width: 300px;
            height: 150px;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            resize: none;
        }
        .options {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            color: #fff;
            background-color: #007bff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        button.secondary {
            background-color: #6c757d;
        }
        button.secondary:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>
    <h1>Temperature Conversion Image Generator</h1>
    <div class="input-section">
        <textarea id="line1" placeholder="Enter temperatures (one per line, e.g., 27 or 36.5)"></textarea>
        <div class="options">
            <button id="generate-png-btn">Download PNG</button>
            <button id="generate-webp-btn" class="secondary">Download WebP</button>
        </div>
    </div>
    <script>
        // èŽ·å–å…ƒç´ 
        const line1Input = document.getElementById('line1');
        const generatePngBtn = document.getElementById('generate-png-btn');
        const generateWebpBtn = document.getElementById('generate-webp-btn');

        // æ¸©åº¦è½¬æ¢å‡½æ•°
        function celsiusToFahrenheit(celsius) {
            return (celsius * 9 / 5 + 32).toFixed(2); // ä¿ç•™ä¸¤ä½å°æ•°
        }

        // ç”Ÿæˆå›¾ç‰‡åç§°ï¼ˆæ ¼å¼ï¼šæ•°å­—-celsius-to-fahrenheit-conversion.æ‰©å±•åï¼‰
        function generateFileName(celsius, fileExtension) {
            const numberPart = celsius.toString().replace('.', '-');
            return `${numberPart}-celsius-to-fahrenheit-conversion.${fileExtension}`;
        }

        // ç”Ÿæˆå¹¶ä¸‹è½½å›¾ç‰?
        function generateAndDownloadImage(inputText, index, format = 'png') {
            // å°è¯•æå–æ•°å­—
            let celsius;
            try {
                celsius = parseFloat(inputText.trim());
                if (isNaN(celsius)) {
                    throw new Error("Not a number");
                }
            } catch (e) {
                console.warn(`Invalid input at line ${index + 1}: ${inputText}`);
                return;
            }

            const fahrenheit = celsiusToFahrenheit(celsius);

            // ç”Ÿæˆæ˜¾ç¤ºæ–‡æœ¬
            const displayText = `${celsius}Â°C to Â°F`;
            const conversionText = `${celsius}Â°C = ${fahrenheit}Â°F`;

            // åˆ›å»º Canvas
            const canvas = document.createElement('canvas');
            canvas.width = 1200;
            canvas.height = 400;
            const ctx = canvas.getContext('2d');

            // è®¾ç½®èƒŒæ™¯é¢œè‰²
            ctx.fillStyle = '#ffffff'; // ç™½è‰²èƒŒæ™¯
            ctx.fillRect(0, 0, 1200, 400);

            // è®¾ç½®å­—ä½“æ ·å¼
            ctx.fillStyle = '#000000'; // é»‘è‰²å­—ä½“
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';

            // ç»˜åˆ¶ç¬¬ä¸€è¡Œæ–‡å­—ï¼ˆæ¸©åº¦è½¬æ¢æ ‡é¢˜ï¼?
            ctx.font = 'bold 36px Arial'; // ç¨å°å­—ä½“
            ctx.fillText(displayText, 600, 150); // å±…ä¸­æ˜¾ç¤º

            // ç»˜åˆ¶ç¬¬äºŒè¡Œæ–‡å­—ï¼ˆè½¬æ¢ç»“æžœï¼?
            ctx.font = 'bold 48px Arial'; // å¤§å­—ä½“ï¼ŒåŠ ç²—
            ctx.fillText(conversionText, 600, 250); // å±…ä¸­æ˜¾ç¤º

            // å°?Canvas è½¬æ¢ä¸ºå›¾ç‰‡å¹¶è§¦å‘ä¸‹è½½
            let mimeType, fileExtension;
            if (format === 'webp') {
                mimeType = 'image/webp';
                fileExtension = 'webp';
            } else {
                mimeType = 'image/png';
                fileExtension = 'png';
            }

            canvas.toBlob((blob) => {
                const imageURL = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = imageURL;

                // ç”Ÿæˆå›¾ç‰‡åç§°
                const fileName = generateFileName(celsius, fileExtension);
                link.download = fileName;

                // è§¦å‘ä¸‹è½½
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // é‡Šæ”¾å†…å­˜
                setTimeout(() => URL.revokeObjectURL(imageURL), 100);
            }, mimeType, 0.9); // WebP è´¨é‡è®¾ç½®ä¸?0.9
        }

        // æ‰¹é‡ç”Ÿæˆå¹¶ä¸‹è½½å›¾ç‰?
        function generateAndDownloadImages(inputTexts, format) {
            inputTexts.forEach((inputText, index) => {
                if (inputText.trim()) {
                    generateAndDownloadImage(inputText.trim(), index, format);
                }
            });
        }

        // ç»‘å®šç”ŸæˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶
        generatePngBtn.addEventListener('click', () => {
            const inputTexts = line1Input.value.split('\n'); // æŒ‰è¡Œåˆ†å‰²è¾“å…¥å†…å®¹
            if (inputTexts.length > 0) {
                generateAndDownloadImages(inputTexts, 'png');
            } else {
                alert('Please enter temperatures.');
            }
        });

        generateWebpBtn.addEventListener('click', () => {
            const inputTexts = line1Input.value.split('\n'); // æŒ‰è¡Œåˆ†å‰²è¾“å…¥å†…å®¹
            if (inputTexts.length > 0) {
                generateAndDownloadImages(inputTexts, 'webp');
            } else {
                alert('Please enter temperatures.');
            }
        });
    </script>
</body>
</html>


