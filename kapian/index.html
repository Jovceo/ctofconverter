<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Temperature Conversion Image Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            color: #333;
        }
        .input-section {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        textarea {
            width: 300px;
            height: 150px;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            resize: none;
        }
        .options {
            margin-top: 10px;
            display: flex;
            gap: 10px;
            width: 100%;
            max-width: 300px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            flex: 1;
        }
        button:hover {
            opacity: 0.9;
        }
        .png-btn {
            background-color: #007bff;
        }
        .webp-btn {
            background-color: #6c757d;
        }
        .info-text {
            margin-top: 10px;
            color: #666;
            font-size: 14px;
            text-align: center;
        }
        .info-text ul {
            text-align: left;
            margin: 5px 0;
            padding-left: 20px;
        }
        .info-text li {
            margin-bottom: 3px;
        }
    </style>
</head>
<body>
    <h1>Smart Temperature Conversion Image Generator</h1>
    <div class="input-section">
        <textarea id="line1" placeholder="Enter temperatures (e.g., 100F, 100 f to c, 100 degrees f to c)"></textarea>
        <div class="options">
            <button id="generate-png-btn" class="png-btn">Download PNG</button>
            <button id="generate-webp-btn" class="webp-btn">Download WebP</button>
        </div>
        <div class="info-text">
            Tip: Supported formats: 
            <ul>
                <li>100F or 100 F</li>
                <li>100 f to c</li>
                <li>100 degrees fahrenheit to celsius</li>
                <li>37C or 37 C</li>
                <li>37 c to f</li>
                <li>37 degrees celsius to fahrenheit</li>
            </ul>
            Plain numbers will be treated as Celsius to Fahrenheit
        </div>
    </div>
    <script>
        // èŽ·å–å…ƒç´ 
        const line1Input = document.getElementById('line1');
        const generatePngBtn = document.getElementById('generate-png-btn');
        const generateWebpBtn = document.getElementById('generate-webp-btn');

        // æ¸©åº¦è½¬æ¢å‡½æ•°
        function celsiusToFahrenheit(celsius) {
            return (celsius * 9 / 5 + 32).toFixed(2);
        }

        function fahrenheitToCelsius(fahrenheit) {
            return ((fahrenheit - 32) * 5 / 9).toFixed(2);
        }

        // æ£€æµ‹æ¸©åº¦å•ä½å¹¶è½¬æ¢ï¼ˆæ”¯æŒå¤šç§è¡¨è¾¾æ–¹å¼ï¼‰
        function detectAndConvert(tempStr) {
            // å°è¯•åŒ¹é…å¤šç§æ¸©åº¦è½¬æ¢è¡¨è¾¾æ–¹å¼
            const patterns = [
                // æ ¼å¼: æ•°å­— + å•ä½ (å¦?100F, 100 F)
                /^([-+]?\d*\.?\d+)\s*([CFcf])$/,
                // æ ¼å¼: æ•°å­— + å•ä½ + to + å•ä½ (å¦?100F to C, 100 f to c)
                /^([-+]?\d*\.?\d+)\s*([CFcf])\s*to\s*([CFcf])$/i,
                // æ ¼å¼: æ•°å­— + "degrees" + å•ä½ + to + å•ä½ (å¦?100 degrees f to c)
                /^([-+]?\d*\.?\d+)\s*degrees?\s*([CFcf])\s*to\s*([CFcf])$/i,
                // æ ¼å¼: æ•°å­— + "degrees" + å•ä½å…¨ç§° + to + å•ä½å…¨ç§° (å¦?100 degrees fahrenheit to celsius)
                /^([-+]?\d*\.?\d+)\s*degrees?\s*(fahrenheit|celsius)\s*to\s*(fahrenheit|celsius)$/i,
                // æ ¼å¼: çº¯æ•°å­?(é»˜è®¤Cè½¬F)
                /^([-+]?\d*\.?\d+)$/
            ];
            
            let match;
            for (const pattern of patterns) {
                match = tempStr.match(pattern);
                if (match) break;
            }
            
            if (!match) return null;
            
            const value = parseFloat(match[1]);
            let fromUnit, toUnit;
            
            // å¤„ç†ä¸åŒåŒ¹é…æ¨¡å¼
            if (match[2] && match[2].toLowerCase() === 'c') {
                fromUnit = 'C';
            } else if (match[2] && match[2].toLowerCase() === 'f') {
                fromUnit = 'F';
            } else if (match[2] && match[2].toLowerCase().includes('celsius')) {
                fromUnit = 'C';
            } else if (match[2] && match[2].toLowerCase().includes('fahrenheit')) {
                fromUnit = 'F';
            } else {
                // é»˜è®¤çº¯æ•°å­—è§†ä¸ºCè½¬F
                fromUnit = 'C';
            }
            
            // å¦‚æžœæœ‰æŒ‡å®šç›®æ ‡å•ä½?            if (match[3]) {
                if (match[3].toLowerCase() === 'c') {
                    toUnit = 'C';
                } else if (match[3].toLowerCase() === 'f') {
                    toUnit = 'F';
                } else if (match[3].toLowerCase().includes('celsius')) {
                    toUnit = 'C';
                } else if (match[3].toLowerCase().includes('fahrenheit')) {
                    toUnit = 'F';
                } else {
                    // å¦‚æžœæ²¡æœ‰æ˜Žç¡®æŒ‡å®šï¼Œè‡ªåŠ¨æŽ¨æ–?ä¸Žè¾“å…¥å•ä½ç›¸å?
                    toUnit = fromUnit === 'C' ? 'F' : 'C';
                }
            } else {
                // å¦‚æžœæ²¡æœ‰æ˜Žç¡®æŒ‡å®šï¼Œè‡ªåŠ¨æŽ¨æ–?ä¸Žè¾“å…¥å•ä½ç›¸å?
                toUnit = fromUnit === 'C' ? 'F' : 'C';
            }
            
            if (fromUnit === 'C' && toUnit === 'F') {
                return {
                    fromUnit: 'Â°C',
                    toUnit: 'Â°F',
                    original: value,
                    converted: celsiusToFahrenheit(value),
                    type: 'c-to-f'
                };
            } else if (fromUnit === 'F' && toUnit === 'C') {
                return {
                    fromUnit: 'Â°F',
                    toUnit: 'Â°C',
                    original: value,
                    converted: fahrenheitToCelsius(value),
                    type: 'f-to-c'
                };
            }
            
            return null;
        }

        // ç”Ÿæˆå›¾ç‰‡åç§°
        function generateFileName(original, conversionType, fileExtension) {
            const numberPart = original.toString().replace('.', '-');
            if (conversionType === 'c-to-f') {
                return `${numberPart}-celsius-to-fahrenheit-conversion.${fileExtension}`;
            } else {
                return `${numberPart}-fahrenheit-to-celsius-conversion.${fileExtension}`;
            }
        }

        // ç”Ÿæˆå¹¶ä¸‹è½½å›¾ç‰?        function generateAndDownloadImage(inputText, index, format = 'png') {
            const conversion = detectAndConvert(inputText.trim());
            if (!conversion) {
                console.warn(`Invalid input at line ${index + 1}: ${inputText}`);
                return;
            }

            const { fromUnit, toUnit, original, converted, type } = conversion;
            const displayText = `${original}${fromUnit} to ${toUnit}`;
            const conversionText = `${original}${fromUnit} = ${converted}${toUnit}`;

            // åˆ›å»º Canvas
            const canvas = document.createElement('canvas');
            canvas.width = 1200;
            canvas.height = 400;
            const ctx = canvas.getContext('2d');

            // è®¾ç½®èƒŒæ™¯é¢œè‰²
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, 1200, 400);

            // è®¾ç½®å­—ä½“æ ·å¼
            ctx.fillStyle = '#000000';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';

            // ç»˜åˆ¶ç¬¬ä¸€è¡Œæ–‡å­—ï¼ˆæ¸©åº¦è½¬æ¢æ ‡é¢˜ï¼?            ctx.font = 'bold 36px Arial';
            ctx.fillText(displayText, 600, 150);

            // ç»˜åˆ¶ç¬¬äºŒè¡Œæ–‡å­—ï¼ˆè½¬æ¢ç»“æžœï¼?            ctx.font = 'bold 48px Arial';
            ctx.fillText(conversionText, 600, 250);

            // å°?Canvas è½¬æ¢ä¸ºå›¾ç‰‡å¹¶è§¦å‘ä¸‹è½½
            const mimeType = format === 'webp' ? 'image/webp' : 'image/png';
            const fileExtension = format === 'webp' ? 'webp' : 'png';

            canvas.toBlob((blob) => {
                const imageURL = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = imageURL;
                link.download = generateFileName(original, type, fileExtension);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                setTimeout(() => URL.revokeObjectURL(imageURL), 100);
            }, mimeType, 0.9);
        }

        // æ‰¹é‡ç”Ÿæˆå¹¶ä¸‹è½½å›¾ç‰?        function generateAndDownloadImages(inputTexts, format) {
            inputTexts.forEach((inputText, index) => {
                if (inputText.trim()) {
                    generateAndDownloadImage(inputText.trim(), index, format);
                }
            });
        }

        // ç»‘å®šç”ŸæˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶
        generatePngBtn.addEventListener('click', () => {
            const inputTexts = line1Input.value.split('\n');
            if (inputTexts.length > 0) {
                generateAndDownloadImages(inputTexts, 'png');
            } else {
                alert('Please enter temperatures.');
            }
        });

        generateWebpBtn.addEventListener('click', () => {
            const inputTexts = line1Input.value.split('\n');
            if (inputTexts.length > 0) {
                generateAndDownloadImages(inputTexts, 'webp');
            } else {
                alert('Please enter temperatures.');
            }
        });
    </script>
</body>
</html>


